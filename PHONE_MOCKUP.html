<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Mock</title>
    <style>
        :root {
            --app-bg: #f0f2f5;
            --phone-bg: #ffffff;
            --header-bg: #f0f2f5;
            --header-fg: #111b21;
            --bubble-me: #d9fdd3;
            --bubble-them: #ffffff;
            --accent: #00a884;
            --timestamp: #667781;
            --chat-wallpaper: #efeae2;
            --shadow: 0 10px 30px rgba(0,0,0,0.4);
        }

        * { box-sizing: border-box; }
        html, body { height: 100%; }
        body {
            margin: 0;
            background: var(--app-bg);
            color: #e9edef;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
            padding: 0;
            display: block;
            height: 100%;
            width: 100%;
        }

        .layout {
            width: 100%;
            height: 100%;
            display: block;
        }


        .phone {
            width: 100%;
            height: 100vh;
            background: var(--phone-bg);
            display: grid;
            grid-template-rows: 56px 1fr 60px;
            overflow: hidden;
            position: relative;
            border: none;
            border-radius: 0;
            box-shadow: none;
            max-width: none;
        }

        .app-header {
            background: var(--header-bg);
            color: var(--header-fg);
            display: grid;
            grid-template-columns: 48px 1fr 48px;
            align-items: center;
            padding: 8px 8px 0 8px;
            gap: 8px;
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 999px;
            background: #2c3a41;
            display: grid;
            place-items: center;
            color: #b9c0c5;
            font-weight: 700;
            border: 1px solid #314149;
            justify-self: center;
        }

        .contact {
            min-width: 0;
        }
        .contact .name {
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .contact .status {
            font-size: 12px;
            color: #aeb5ba;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat {
            position: relative;
            overflow-y: auto;
            padding: 16px 12px 24px 12px;
            background: var(--chat-wallpaper);
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .composer {
            background: var(--header-bg);
            display: grid;
            grid-template-columns: 1fr 44px;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            border-top: 1px solid #223039;
        }
        .composer input {
            background: #ffffff;
            color: #111b21;
            border: 1px solid #d1d7db;
            border-radius: 20px;
            padding: 10px 12px;
            outline: none;
            width: 100%;
        }
        .composer button {
            background: var(--accent);
            border: none;
            border-radius: 999px;
            color: #052019;
            font-weight: 700;
            height: 36px;
            cursor: pointer;
        }

        .row { display: flex; gap: 6px; align-items: flex-end; }
        .row.me { justify-content: flex-end; }
        .row.them { justify-content: flex-start; }

        .bubble {
            max-width: 78%;
            padding: 8px 10px 6px 10px;
            border-radius: 12px;
            position: relative;
            line-height: 1.25;
            font-size: 14px;
            word-wrap: break-word;
            background: var(--bubble-them);
            color: #111b21;
            animation: pop-in 200ms ease-out;
            box-shadow: 0 1px 0 rgba(0,0,0,0.25);
        }
        .row.me .bubble {
            background: var(--bubble-me);
            color: #111b21;
        }
        .row.them .bubble {
            background: var(--bubble-them);
            color: #111b21;
        }

        .meta {
            display: inline-flex;
            gap: 6px;
            align-items: center;
            color: var(--timestamp);
            font-size: 11px;
            margin-left: 8px;
        }

        .ticks {
            display: inline-grid;
            grid-auto-flow: column;
            gap: 2px;
            transform: translateY(1px);
        }
        .tick {
            width: 10px; height: 10px;
            background: currentColor;
            -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>') center/contain no-repeat;
            mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>') center/contain no-repeat;
        }
        .tick.read { color: #53bdeb; }

        .time {
            color: var(--timestamp);
            font-size: 11px;
            user-select: none;
            white-space: nowrap;
        }

        .typewriter-text {
            position: relative;
        }
        .typewriter-text.typing::after {
            content: '|';
            color: var(--timestamp);
            animation: blink 1s infinite;
            margin-left: 1px;
        }

        .typing {
            color: var(--timestamp);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 12px;
            margin: 6px 0;
            width: fit-content;
            animation: fade-in 120ms ease-out;
        }
        .dots {
            display: inline-grid; grid-auto-flow: column; gap: 4px;
        }
        .dot {
            width: 6px; height: 6px; border-radius: 999px; background: #9aa1a7;
            animation: bob 1.2s infinite ease-in-out;
        }
        .dot:nth-child(2) { animation-delay: 0.15s; }
        .dot:nth-child(3) { animation-delay: 0.3s; }

        .system {
            align-self: center;
            background: rgba(255,255,255,0.06);
            color: #cfd5d9;
            padding: 6px 10px;
            border-radius: 10px;
            font-size: 12px;
            margin: 8px 0;
        }

        @keyframes pop-in {
            from { opacity: 0; transform: translateY(6px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bob {
            0%, 80%, 100% { transform: translateY(0); opacity: 0.6; }
            40% { transform: translateY(-2px); opacity: 1; }
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

    </style>
</head>
<body>
    <div class="layout">
        <div class="phone" aria-label="WhatsApp mock phone">
            <div class="app-header">
                <div class="avatar" id="avatar">W</div>
                <div class="contact">
                    <div class="name" id="contactName">Cliente 1</div>
                    <div class="status" id="contactStatus">online</div>
                </div>
                <div style="display:grid;place-items:center;color:#9aa1a7">‚ãÆ</div>
            </div>
            <div id="chat" class="chat" role="log" aria-live="polite"></div>
            <div class="composer" aria-hidden="true">
                <input type="text" placeholder="Message" disabled>
                <button disabled>‚û§</button>
            </div>
        </div>


    </div>

    <script>
        const chatEl = document.getElementById('chat');


        const contactNameEl = document.getElementById('contactName');
        const contactStatusEl = document.getElementById('contactStatus');
        const avatarEl = document.getElementById('avatar');

        /** Default demo config */
        const defaultConfig = {
            meta: {
                contactName: "WhatsApp Bot",
                avatarText: "W",
                status: "online",
                theme: {
                    accent: "#00a884",
                    bubbleMe: "#d9fdd3",
                    bubbleThem: "#ffffff",
                    headerBg: "#f0f2f5",
                    wallpaper: "#efeae2"
                }
            },
            messages: [
                { from: "them", text: "Hola! Necesito ayuda", typingMs: 800, time: "14:30" },
                { from: "me", text: "¬°Hola! ¬øEn qu√© puedo ayudarte?", time: "14:30", status: "delivered" },
                { from: "them", text: "Mi pedido #12345", typingMs: 600, time: "14:31" },
                { from: "me", text: "Revisando tu pedido... üîç", time: "14:31", status: "delivered" },
                { from: "me", text: "Laptop Dell XPS 13 - $1,299\nEstado: En tr√°nsito\nLlega ma√±ana 2-6 PM", time: "14:32", status: "read" },
                { from: "them", text: "¬øDirecci√≥n correcta?", typingMs: 700, time: "14:33" },
                { from: "me", text: "Calle Principal 123, Apt 4B\nCiudad, Estado 12345", time: "14:33", status: "delivered" },
                { from: "them", text: "S√≠, correcta. ¬°Gracias!", typingMs: 500, time: "14:34" },
                { from: "me", text: "¬°Perfecto! Te avisaremos ma√±ana üòä", time: "14:34", status: "delivered" }
            ]
        };


        function setTheme(theme) {
            if (!theme) return;
            const root = document.documentElement;
            if (theme.accent) root.style.setProperty('--accent', theme.accent);
            if (theme.bubbleMe) root.style.setProperty('--bubble-me', theme.bubbleMe);
            if (theme.bubbleThem) root.style.setProperty('--bubble-them', theme.bubbleThem);
            if (theme.headerBg) root.style.setProperty('--header-bg', theme.headerBg);
            if (theme.wallpaper) root.style.setProperty('--chat-wallpaper', theme.wallpaper);
        }

        function clearChat() {
            chatEl.innerHTML = '';
        }

        function scrollToBottom() {
            chatEl.scrollTo({ top: chatEl.scrollHeight, behavior: 'smooth' });
        }

        function createRowElement(from) {
            const row = document.createElement('div');
            row.className = `row ${from}`;
            return row;
        }

        function createBubbleContent(msg) {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';

            if (msg.imageUrl) {
                const img = document.createElement('img');
                img.src = msg.imageUrl;
                img.alt = msg.text || 'Image';
                img.style.maxWidth = '220px';
                img.style.maxHeight = '220px';
                img.style.borderRadius = '8px';
                img.style.display = 'block';
                bubble.appendChild(img);
                if (msg.text) {
                    const caption = document.createElement('div');
                    caption.textContent = msg.text;
                    caption.style.marginTop = '6px';
                    bubble.appendChild(caption);
                }
            } else if (msg.text) {
                if (msg.from === 'me') {
                    // Create a container for typewriter text
                    const textContainer = document.createElement('div');
                    textContainer.className = 'typewriter-text';
                    bubble.appendChild(textContainer);
                } else {
                    bubble.textContent = msg.text;
                }
            }

            const meta = document.createElement('span');
            meta.className = 'meta';
            if (msg.time) {
                const time = document.createElement('span');
                time.className = 'time';
                time.textContent = msg.time;
                meta.appendChild(time);
            }
            if (msg.from === 'me' && msg.status) {
                const ticks = document.createElement('span');
                ticks.className = 'ticks';
                const t1 = document.createElement('span'); t1.className = 'tick';
                const t2 = document.createElement('span'); t2.className = 'tick';
                if (msg.status === 'read') { t1.classList.add('read'); t2.classList.add('read'); }
                ticks.appendChild(t1); ticks.appendChild(t2);
                meta.appendChild(ticks);
            }
            bubble.appendChild(meta);

            return bubble;
        }

        function showTyping(from = 'them', typingMs = 900) {
            const row = createRowElement(from);
            const typing = document.createElement('div');
            typing.className = 'typing';
            const label = document.createElement('span'); label.textContent = 'typing';
            const dots = document.createElement('span'); dots.className = 'dots';
            dots.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span>';
            typing.appendChild(label); typing.appendChild(dots);
            row.appendChild(typing);
            chatEl.appendChild(row);
            scrollToBottom();
            let removed = false;
            return new Promise(resolve => {
                setTimeout(() => {
                    if (!removed) {
                        row.remove();
                        resolve();
                    }
                }, Math.max(0, typingMs));
            });
        }

        function typewriterEffect(element, text, speed = 30) {
            return new Promise((resolve) => {
                let i = 0;
                element.textContent = '';
                element.classList.add('typing');
                
                function typeChar() {
                    if (i < text.length) {
                        element.textContent += text.charAt(i);
                        i++;
                        scrollToBottom();
                        setTimeout(typeChar, speed);
                    } else {
                        element.classList.remove('typing');
                        resolve();
                    }
                }
                
                typeChar();
            });
        }

        async function appendMessage(msg) {
            if (msg.from === 'system') {
                const sys = document.createElement('div');
                sys.className = 'system';
                sys.textContent = msg.text || '';
                chatEl.appendChild(sys);
                scrollToBottom();
                return;
            }
            const row = createRowElement(msg.from === 'me' ? 'me' : 'them');
            const bubble = createBubbleContent(msg);
            row.appendChild(bubble);
            chatEl.appendChild(row);
            scrollToBottom();

            // Apply typewriter effect for "me" messages
            if (msg.from === 'me' && msg.text) {
                const textContainer = bubble.querySelector('.typewriter-text');
                if (textContainer) {
                    await typewriterEffect(textContainer, msg.text, 25);
                }
            }
        }

        async function playSequence(config) {
            clearChat();
            const meta = config.meta || {};
            contactNameEl.textContent = meta.contactName || 'Contact';
            contactStatusEl.textContent = meta.status || 'online';
            avatarEl.textContent = (meta.avatarText || (meta.contactName || '?').slice(0,1)).toUpperCase();
            setTheme(meta.theme);

            const messages = Array.isArray(config.messages) ? config.messages : [];
            for (const msg of messages) {
                const delay = typeof msg.delayMs === 'number' ? msg.delayMs : 250;
                await new Promise(r => setTimeout(r, delay));
                if (msg.from === 'them' && (msg.typingMs || 0) > 0) {
                    await showTyping('them', msg.typingMs);
                }
                await appendMessage(msg);
            }
        }





        // Initialize
        playSequence(defaultConfig);

    </script>
</body>
</html>